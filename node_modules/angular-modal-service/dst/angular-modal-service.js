!function(e){var n={};function o(t){if(n[t])return n[t].exports;var l=n[t]={i:t,l:!1,exports:{}};return e[t].call(l.exports,l,l.exports,o),l.l=!0,l.exports}o.m=e,o.c=n,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var l in e)o.d(t,l,function(n){return e[n]}.bind(null,l));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o(o.s=0)}([function(e,n,o){"use strict";angular.module("angularModalService",[]).factory("ModalService",["$animate","$document","$compile","$controller","$http","$rootScope","$q","$templateRequest","$timeout",function(e,n,o,t,l,r,c,u,a){return new function(){var l=this;l.openModals=[];var s=function(n,o){var t=n.children();return t.length>0?e.enter(o,n,t[t.length-1]):e.enter(o,n)};l.closeModals=function(e,n){for(;l.openModals.length;)l.openModals[0].close(e,n),l.openModals.splice(0,1)},l.showModal=function(i){var p=angular.element(n[0].body),d=c.defer();return i.controller?(function(e,n){var o=c.defer();return e?o.resolve(e):n?u(n,!0).then(function(e){o.resolve(e)},function(e){o.reject(e)}):o.reject("No template or templateUrl has been specified."),o.promise}(i.template,i.templateUrl).then(function(n){var u={},f=(i.scope||r).$new(),m=null,v=i.locationChangeSuccess;!1===v?m=angular.noop:angular.isNumber(v)&&v>=0?a(function(){m=r.$on("$locationChangeSuccess",S)},v):m=r.$on("$locationChangeSuccess",S);var b=c.defer(),g=c.defer(),y=!1,h={$scope:f,close:function(e,n){"function"==typeof i.preClose&&i.preClose(u,e,n),void 0!==n&&null!==n||(n=0),y||(y=!0,a(function(){S(e)},n))}};i.inputs&&angular.extend(h,i.inputs);var $=o(n)(f);h.$element=$;var M=f[i.controllerAs],j=t(i.controller,h,!1,i.controllerAs);function S(n){b.resolve(n),i.bodyClass&&p[0].classList.remove(i.bodyClass),e.leave($).then(function(){if($){g.resolve(n),f.$destroy();for(var e=0;e<l.openModals.length;e++)if(l.openModals[e].modal===u){l.openModals.splice(e,1);break}h.close=null,d=null,b=null,u=null,h=null,$=null,f=null}}),m&&m()}i.controllerAs&&M&&angular.extend(j,M),i.appendElement?s(i.appendElement,$):s(p,$),i.bodyClass&&p[0].classList.add(i.bodyClass),u.controller=j,u.scope=f,u.element=$,u.close=b.promise,u.closed=g.promise,d.resolve(u),document.activeElement.blur(),l.openModals.push({modal:u,close:h.close})}).then(null,function(e){d.reject(e)}),d.promise):(d.reject("No controller has been specified."),d.promise)}}}])}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FuZ3VsYXItbW9kYWwtc2VydmljZS5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImFuZ3VsYXIiLCJmYWN0b3J5IiwiJGFuaW1hdGUiLCIkZG9jdW1lbnQiLCIkY29tcGlsZSIsIiRjb250cm9sbGVyIiwiJGh0dHAiLCIkcm9vdFNjb3BlIiwiJHEiLCIkdGVtcGxhdGVSZXF1ZXN0IiwiJHRpbWVvdXQiLCJzZWxmIiwidGhpcyIsIm9wZW5Nb2RhbHMiLCJhcHBlbmRDaGlsZCIsInBhcmVudCIsImNoaWxkIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJlbnRlciIsImNsb3NlTW9kYWxzIiwicmVzdWx0IiwiZGVsYXkiLCJjbG9zZSIsInNwbGljZSIsInNob3dNb2RhbCIsIm9wdGlvbnMiLCJib2R5IiwiZWxlbWVudCIsImRlZmVycmVkIiwiZGVmZXIiLCJjb250cm9sbGVyIiwidGVtcGxhdGUiLCJ0ZW1wbGF0ZVVybCIsInJlc29sdmUiLCJ0aGVuIiwiZXJyb3IiLCJyZWplY3QiLCJwcm9taXNlIiwiZ2V0VGVtcGxhdGUiLCJtb2RhbCIsIm1vZGFsU2NvcGUiLCJzY29wZSIsIiRuZXciLCJyb290U2NvcGVPbkNsb3NlIiwibG9jYXRpb25DaGFuZ2VTdWNjZXNzIiwibm9vcCIsImlzTnVtYmVyIiwiJG9uIiwiY2xlYW5VcENsb3NlIiwiY2xvc2VEZWZlcnJlZCIsImNsb3NlZERlZmVycmVkIiwiaGFzQWxyZWFkeUJlZW5DbG9zZWQiLCJpbnB1dHMiLCIkc2NvcGUiLCJwcmVDbG9zZSIsInVuZGVmaW5lZCIsImV4dGVuZCIsIm1vZGFsRWxlbWVudCIsImxpbmtGbiIsIiRlbGVtZW50IiwiY29udHJvbGxlck9iakJlZm9yZSIsImNvbnRyb2xsZXJBcyIsIm1vZGFsQ29udHJvbGxlciIsImJvZHlDbGFzcyIsImNsYXNzTGlzdCIsInJlbW92ZSIsImxlYXZlIiwiJGRlc3Ryb3kiLCJhcHBlbmRFbGVtZW50IiwiYWRkIiwiY2xvc2VkIiwiZG9jdW1lbnQiLCJhY3RpdmVFbGVtZW50IiwiYmx1ciIsInB1c2giXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsYUFBd0RDLE1BQUEsV0FFeERQLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURtQixPQUFBLEtBUWpEckIsRUFBQXNCLEVBQUEsU0FBQUQsRUFBQUUsR0FFQSxH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QixFQUNoQmxCLEVBQU1qQixNQUFRMkIsRUFBY1osUUFDNUJFLEVBQU0rQixPQUFTcEIsRUFBZWIsUUFHOUJULEVBQVNLLFFBQVFNLEdBR2pCZ0MsU0FBU0MsY0FBY0MsT0FHdkIvRCxFQUFLRSxXQUFXOEQsTUFBT25DLE1BQU9BLEVBQU9qQixNQUFPOEIsRUFBTzlCLFVBbURwRFksS0FBSyxLQUFNLFNBQVNDLEdBQ25CUCxFQUFTUSxPQUFPRCxLQUdiUCxFQUFTUyxVQXJLZFQsRUFBU1EsT0FBTyxxQ0FDVFIsRUFBU1MiLCJmaWxlIjoiYW5ndWxhci1tb2RhbC1zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJNb2RhbFNlcnZpY2UnLCBbXSk7XG5cbm1vZHVsZS5mYWN0b3J5KCdNb2RhbFNlcnZpY2UnLCBbJyRhbmltYXRlJywgJyRkb2N1bWVudCcsICckY29tcGlsZScsICckY29udHJvbGxlcicsICckaHR0cCcsICckcm9vdFNjb3BlJywgJyRxJywgJyR0ZW1wbGF0ZVJlcXVlc3QnLCAnJHRpbWVvdXQnLFxuICBmdW5jdGlvbigkYW5pbWF0ZSwgJGRvY3VtZW50LCAkY29tcGlsZSwgJGNvbnRyb2xsZXIsICRodHRwLCAkcm9vdFNjb3BlLCAkcSwgJHRlbXBsYXRlUmVxdWVzdCwgJHRpbWVvdXQpIHtcblxuICBmdW5jdGlvbiBNb2RhbFNlcnZpY2UoKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAvLyAgVHJhY2sgb3BlbiBtb2RhbHMuXG4gICAgc2VsZi5vcGVuTW9kYWxzID0gW107XG5cbiAgICAvLyAgUmV0dXJucyBhIHByb21pc2Ugd2hpY2ggZ2V0cyB0aGUgdGVtcGxhdGUsIGVpdGhlclxuICAgIC8vICBmcm9tIHRoZSB0ZW1wbGF0ZSBwYXJhbWV0ZXIgb3IgdmlhIGEgcmVxdWVzdCB0byB0aGVcbiAgICAvLyAgdGVtcGxhdGUgdXJsIHBhcmFtZXRlci5cbiAgICB2YXIgZ2V0VGVtcGxhdGUgPSBmdW5jdGlvbih0ZW1wbGF0ZSwgdGVtcGxhdGVVcmwpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICBpZiAodGVtcGxhdGUpIHtcbiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh0ZW1wbGF0ZSk7XG4gICAgICB9IGVsc2UgaWYgKHRlbXBsYXRlVXJsKSB7XG4gICAgICAgICR0ZW1wbGF0ZVJlcXVlc3QodGVtcGxhdGVVcmwsIHRydWUpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24odGVtcGxhdGUpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUodGVtcGxhdGUpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVmZXJyZWQucmVqZWN0KFwiTm8gdGVtcGxhdGUgb3IgdGVtcGxhdGVVcmwgaGFzIGJlZW4gc3BlY2lmaWVkLlwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG5cbiAgICAvLyAgQWRkcyBhbiBlbGVtZW50IHRvIHRoZSBET00gYXMgdGhlIGxhc3QgY2hpbGQgb2YgaXRzIGNvbnRhaW5lclxuICAgIC8vICBsaWtlIGFwcGVuZCwgYnV0IHVzZXMgJGFuaW1hdGUgdG8gaGFuZGxlIGFuaW1hdGlvbnMuIFJldHVybnMgYVxuICAgIC8vICBwcm9taXNlIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSBhbGwgYW5pbWF0aW9uIGlzIGNvbXBsZXRlLlxuICAgIHZhciBhcHBlbmRDaGlsZCA9IGZ1bmN0aW9uKHBhcmVudCwgY2hpbGQpIHtcbiAgICAgIHZhciBjaGlsZHJlbiA9IHBhcmVudC5jaGlsZHJlbigpO1xuICAgICAgaWYgKGNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuICRhbmltYXRlLmVudGVyKGNoaWxkLCBwYXJlbnQsIGNoaWxkcmVuW2NoaWxkcmVuLmxlbmd0aCAtIDFdKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAkYW5pbWF0ZS5lbnRlcihjaGlsZCwgcGFyZW50KTtcbiAgICB9O1xuXG4gICAgLy8gIENsb3NlIGFsbCBtb2RhbHMsIHByb3ZpZGluZyB0aGUgZ2l2ZW4gcmVzdWx0IHRvIHRoZSBjbG9zZSBwcm9taXNlLlxuICAgIHNlbGYuY2xvc2VNb2RhbHMgPSBmdW5jdGlvbihyZXN1bHQsIGRlbGF5KSB7XG4gICAgICB3aGlsZSAoc2VsZi5vcGVuTW9kYWxzLmxlbmd0aCkge1xuICAgICAgICBzZWxmLm9wZW5Nb2RhbHNbMF0uY2xvc2UocmVzdWx0LCBkZWxheSk7XG4gICAgICAgIHNlbGYub3Blbk1vZGFscy5zcGxpY2UoMCwgMSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHNlbGYuc2hvd01vZGFsID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXG4gICAgICAvLyAgR2V0IHRoZSBib2R5IG9mIHRoZSBkb2N1bWVudCwgd2UnbGwgYWRkIHRoZSBtb2RhbCB0byB0aGlzLlxuICAgICAgdmFyIGJvZHkgPSBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLmJvZHkpO1xuXG4gICAgICAvLyAgQ3JlYXRlIGEgZGVmZXJyZWQgd2UnbGwgcmVzb2x2ZSB3aGVuIHRoZSBtb2RhbCBpcyByZWFkeS5cbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgIC8vICBWYWxpZGF0ZSB0aGUgaW5wdXQgcGFyYW1ldGVycy5cbiAgICAgIHZhciBjb250cm9sbGVyTmFtZSA9IG9wdGlvbnMuY29udHJvbGxlcjtcbiAgICAgIGlmICghY29udHJvbGxlck5hbWUpIHtcbiAgICAgICAgZGVmZXJyZWQucmVqZWN0KFwiTm8gY29udHJvbGxlciBoYXMgYmVlbiBzcGVjaWZpZWQuXCIpO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgIH1cblxuICAgICAgLy8gIEdldCB0aGUgYWN0dWFsIGh0bWwgb2YgdGhlIHRlbXBsYXRlLlxuICAgICAgZ2V0VGVtcGxhdGUob3B0aW9ucy50ZW1wbGF0ZSwgb3B0aW9ucy50ZW1wbGF0ZVVybClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24odGVtcGxhdGUpIHtcblxuICAgICAgICAgIC8vICBUaGUgbWFpbiBtb2RhbCBvYmplY3Qgd2Ugd2lsbCBidWlsZC5cbiAgICAgICAgICB2YXIgbW9kYWwgPSB7fTtcblxuICAgICAgICAgIC8vICBDcmVhdGUgYSBuZXcgc2NvcGUgZm9yIHRoZSBtb2RhbC5cbiAgICAgICAgICB2YXIgbW9kYWxTY29wZSA9IChvcHRpb25zLnNjb3BlIHx8ICRyb290U2NvcGUpLiRuZXcoKSxcbiAgICAgICAgICAgICAgcm9vdFNjb3BlT25DbG9zZSA9IG51bGwsXG4gICAgICAgICAgICAgIGxvY2F0aW9uQ2hhbmdlU3VjY2VzcyA9IG9wdGlvbnMubG9jYXRpb25DaGFuZ2VTdWNjZXNzO1xuXG4gICAgICAgICAgICAvLyAgQWxsb3cgbG9jYXRpb25DaGFuZ2VTdWNjZXNzIGV2ZW50IHJlZ2lzdHJhdGlvbiB0byBiZSBjb25maWd1cmFibGUuXG4gICAgICAgICAgICAvLyAgVHJ1ZSAoZGVmYXVsdCkgPSBldmVudCByZWdpc3RlcmVkIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICAvLyAgIyAoZ3JlYXRlciB0aGFuIDApID0gZXZlbnQgcmVnaXN0ZXJlZCB3aXRoIGRlbGF5XG4gICAgICAgICAgICAvLyAgRmFsc2UgPSBkaXNhYmxlZFxuICAgICAgICAgICAgaWYgKGxvY2F0aW9uQ2hhbmdlU3VjY2VzcyA9PT0gZmFsc2Upe1xuICAgICAgICAgICAgICAgIHJvb3RTY29wZU9uQ2xvc2UgPSBhbmd1bGFyLm5vb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhbmd1bGFyLmlzTnVtYmVyKGxvY2F0aW9uQ2hhbmdlU3VjY2VzcykgJiYgbG9jYXRpb25DaGFuZ2VTdWNjZXNzID49IDApIHtcbiAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcm9vdFNjb3BlT25DbG9zZSA9ICRyb290U2NvcGUuJG9uKCckbG9jYXRpb25DaGFuZ2VTdWNjZXNzJywgY2xlYW5VcENsb3NlKTtcbiAgICAgICAgICAgICAgICB9LCBsb2NhdGlvbkNoYW5nZVN1Y2Nlc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcm9vdFNjb3BlT25DbG9zZSA9ICRyb290U2NvcGUuJG9uKCckbG9jYXRpb25DaGFuZ2VTdWNjZXNzJywgY2xlYW5VcENsb3NlKTtcbiAgICAgICAgICAgIH1cblxuXG5cblxuICAgICAgICAgIC8vICBDcmVhdGUgdGhlIGlucHV0cyBvYmplY3QgdG8gdGhlIGNvbnRyb2xsZXIgLSB0aGlzIHdpbGwgaW5jbHVkZVxuICAgICAgICAgIC8vICB0aGUgc2NvcGUsIGFzIHdlbGwgYXMgYWxsIGlucHV0cyBwcm92aWRlZC5cbiAgICAgICAgICAvLyAgV2Ugd2lsbCBhbHNvIGNyZWF0ZSBhIGRlZmVycmVkIHRoYXQgaXMgcmVzb2x2ZWQgd2l0aCBhIHByb3ZpZGVkXG4gICAgICAgICAgLy8gIGNsb3NlIGZ1bmN0aW9uLiBUaGUgY29udHJvbGxlciBjYW4gdGhlbiBjYWxsICdjbG9zZShyZXN1bHQpJy5cbiAgICAgICAgICAvLyAgVGhlIGNvbnRyb2xsZXIgY2FuIGFsc28gcHJvdmlkZSBhIGRlbGF5IGZvciBjbG9zaW5nIC0gdGhpcyBpc1xuICAgICAgICAgIC8vICBoZWxwZnVsIGlmIHRoZXJlIGFyZSBjbG9zaW5nIGFuaW1hdGlvbnMgd2hpY2ggbXVzdCBmaW5pc2ggZmlyc3QuXG4gICAgICAgICAgdmFyIGNsb3NlRGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgIHZhciBjbG9zZWREZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgdmFyIGhhc0FscmVhZHlCZWVuQ2xvc2VkID0gZmFsc2U7XG5cbiAgICAgICAgICB2YXIgaW5wdXRzID0ge1xuICAgICAgICAgICAgJHNjb3BlOiBtb2RhbFNjb3BlLFxuICAgICAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKHJlc3VsdCwgZGVsYXkpIHtcbiAgICAgICAgICAgICAgLy8gIElmIHdlIGhhdmUgYSBwcmUtY2xvc2UgZnVuY3Rpb24sIGNhbGwgaXQuXG4gICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5wcmVDbG9zZSA9PT0gJ2Z1bmN0aW9uJykgb3B0aW9ucy5wcmVDbG9zZShtb2RhbCwgcmVzdWx0LCBkZWxheSk7XG5cbiAgICAgICAgICAgICAgaWYgKGRlbGF5ID09PSB1bmRlZmluZWQgfHwgZGVsYXkgPT09IG51bGwpIGRlbGF5ID0gMDtcbiAgICAgICAgICAgICAgaWYgKGhhc0FscmVhZHlCZWVuQ2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGhhc0FscmVhZHlCZWVuQ2xvc2VkID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIGNsZWFuVXBDbG9zZShyZXN1bHQpO1xuXG4gICAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8gIElmIHdlIGhhdmUgcHJvdmlkZWQgYW55IGlucHV0cywgcGFzcyB0aGVtIHRvIHRoZSBjb250cm9sbGVyLlxuICAgICAgICAgIGlmIChvcHRpb25zLmlucHV0cykgYW5ndWxhci5leHRlbmQoaW5wdXRzLCBvcHRpb25zLmlucHV0cyk7XG5cbiAgICAgICAgICAvLyAgQ29tcGlsZSB0aGVuIGxpbmsgdGhlIHRlbXBsYXRlIGVsZW1lbnQsIGJ1aWxkaW5nIHRoZSBhY3R1YWwgZWxlbWVudC5cbiAgICAgICAgICAvLyAgU2V0IHRoZSAkZWxlbWVudCBvbiB0aGUgaW5wdXRzIHNvIHRoYXQgaXQgY2FuIGJlIGluamVjdGVkIGlmIHJlcXVpcmVkLlxuICAgICAgICAgIHZhciBsaW5rRm4gPSAkY29tcGlsZSh0ZW1wbGF0ZSk7XG4gICAgICAgICAgdmFyIG1vZGFsRWxlbWVudCA9IGxpbmtGbihtb2RhbFNjb3BlKTtcbiAgICAgICAgICBpbnB1dHMuJGVsZW1lbnQgPSBtb2RhbEVsZW1lbnQ7XG5cbiAgICAgICAgICAvLyAgQ3JlYXRlIHRoZSBjb250cm9sbGVyLCBleHBsaWNpdGx5IHNwZWNpZnlpbmcgdGhlIHNjb3BlIHRvIHVzZS5cbiAgICAgICAgICB2YXIgY29udHJvbGxlck9iakJlZm9yZSA9IG1vZGFsU2NvcGVbb3B0aW9ucy5jb250cm9sbGVyQXNdO1xuICAgICAgICAgIHZhciBtb2RhbENvbnRyb2xsZXIgPSAkY29udHJvbGxlcihvcHRpb25zLmNvbnRyb2xsZXIsIGlucHV0cywgZmFsc2UsIG9wdGlvbnMuY29udHJvbGxlckFzKTtcblxuICAgICAgICAgIGlmIChvcHRpb25zLmNvbnRyb2xsZXJBcyAmJiBjb250cm9sbGVyT2JqQmVmb3JlKSB7XG4gICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChtb2RhbENvbnRyb2xsZXIsIGNvbnRyb2xsZXJPYmpCZWZvcmUpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vICBUaGVuLCBhcHBlbmQgdGhlIG1vZGFsIHRvIHRoZSBkb20uXG4gICAgICAgICAgaWYgKG9wdGlvbnMuYXBwZW5kRWxlbWVudCkge1xuICAgICAgICAgICAgLy8gYXBwZW5kIHRvIGN1c3RvbSBhcHBlbmQgZWxlbWVudFxuICAgICAgICAgICAgYXBwZW5kQ2hpbGQob3B0aW9ucy5hcHBlbmRFbGVtZW50LCBtb2RhbEVsZW1lbnQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBhcHBlbmQgdG8gYm9keSB3aGVuIG5vIGN1c3RvbSBhcHBlbmQgZWxlbWVudCBpcyBzcGVjaWZpZWRcbiAgICAgICAgICAgIGFwcGVuZENoaWxkKGJvZHksIG1vZGFsRWxlbWVudCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRmluYWxseSwgYXBwZW5kIGFueSBjdXN0b20gY2xhc3NlcyB0byB0aGUgYm9keVxuICAgICAgICAgIGlmKG9wdGlvbnMuYm9keUNsYXNzKSB7XG4gICAgICAgICAgICBib2R5WzBdLmNsYXNzTGlzdC5hZGQob3B0aW9ucy5ib2R5Q2xhc3MpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vICBQb3B1bGF0ZSB0aGUgbW9kYWwgb2JqZWN0Li4uXG4gICAgICAgICAgbW9kYWwuY29udHJvbGxlciA9IG1vZGFsQ29udHJvbGxlcjtcbiAgICAgICAgICBtb2RhbC5zY29wZSA9IG1vZGFsU2NvcGU7XG4gICAgICAgICAgbW9kYWwuZWxlbWVudCA9IG1vZGFsRWxlbWVudDtcbiAgICAgICAgICBtb2RhbC5jbG9zZSA9IGNsb3NlRGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICBtb2RhbC5jbG9zZWQgPSBjbG9zZWREZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgICAgICAgLy8gIC4uLndoaWNoIGlzIHBhc3NlZCB0byB0aGUgY2FsbGVyIHZpYSB0aGUgcHJvbWlzZS5cbiAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKG1vZGFsKTtcblxuICAgICAgICAgIC8vIENsZWFyIHByZXZpb3VzIGlucHV0IGZvY3VzIHRvIGF2b2lkIG9wZW4gbXVsdGlwbGUgbW9kYWxzIG9uIGVudGVyXG4gICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XG5cbiAgICAgICAgICAvLyAgV2UgY2FuIHRyYWNrIHRoaXMgbW9kYWwgaW4gb3VyIG9wZW4gbW9kYWxzLlxuICAgICAgICAgIHNlbGYub3Blbk1vZGFscy5wdXNoKHsgbW9kYWw6IG1vZGFsLCBjbG9zZTogaW5wdXRzLmNsb3NlIH0pO1xuXG4gICAgICAgICAgZnVuY3Rpb24gY2xlYW5VcENsb3NlKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAvLyAgUmVzb2x2ZSB0aGUgJ2Nsb3NlJyBwcm9taXNlLlxuICAgICAgICAgICAgY2xvc2VEZWZlcnJlZC5yZXNvbHZlKHJlc3VsdCk7XG5cbiAgICAgICAgICAgIC8vICBSZW1vdmUgdGhlIGN1c3RvbSBjbGFzcyBmcm9tIHRoZSBib2R5XG4gICAgICAgICAgICBpZihvcHRpb25zLmJvZHlDbGFzcykge1xuICAgICAgICAgICAgICAgIGJvZHlbMF0uY2xhc3NMaXN0LnJlbW92ZShvcHRpb25zLmJvZHlDbGFzcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vICBMZXQgYW5ndWxhciByZW1vdmUgdGhlIGVsZW1lbnQgYW5kIHdhaXQgZm9yIGFuaW1hdGlvbnMgdG8gZmluaXNoLlxuICAgICAgICAgICAgJGFuaW1hdGUubGVhdmUobW9kYWxFbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gcHJldmVudCBlcnJvciBpZiBtb2RhbCBpcyBhbHJlYWR5IGRlc3Ryb3llZFxuICAgICAgICAgICAgICAgICAgICAgIGlmICghbW9kYWxFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgLy8gIFJlc29sdmUgdGhlICdjbG9zZWQnIHByb21pc2UuXG4gICAgICAgICAgICAgICAgICAgICAgY2xvc2VkRGVmZXJyZWQucmVzb2x2ZShyZXN1bHQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgLy8gIFdlIGNhbiBub3cgY2xlYW4gdXAgdGhlIHNjb3BlXG4gICAgICAgICAgICAgICAgICAgICAgbW9kYWxTY29wZS4kZGVzdHJveSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgLy8gIFJlbW92ZSB0aGUgbW9kYWwgZnJvbSB0aGUgc2V0IG9mIG9wZW4gbW9kYWxzLlxuICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MDsgaTxzZWxmLm9wZW5Nb2RhbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm9wZW5Nb2RhbHNbaV0ubW9kYWwgPT09IG1vZGFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYub3Blbk1vZGFscy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgIC8vICBVbmxlc3Mgd2UgbnVsbCBvdXQgYWxsIG9mIHRoZXNlIG9iamVjdHMgd2Ugc2VlbSB0byBzdWZmZXJcbiAgICAgICAgICAgICAgICAgICAgICAvLyAgZnJvbSBtZW1vcnkgbGVha3MsIGlmIGFueW9uZSBjYW4gZXhwbGFpbiB3aHkgdGhlbiBJJ2RcbiAgICAgICAgICAgICAgICAgICAgICAvLyAgYmUgdmVyeSBpbnRlcmVzdGVkIHRvIGtub3cuXG4gICAgICAgICAgICAgICAgICAgICAgaW5wdXRzLmNsb3NlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgY2xvc2VEZWZlcnJlZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgbW9kYWwgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgIGlucHV0cyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgbW9kYWxFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICBtb2RhbFNjb3BlID0gbnVsbDtcblxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyByZW1vdmUgZXZlbnQgd2F0Y2hlclxuICAgICAgICAgICAgcm9vdFNjb3BlT25DbG9zZSAmJiByb290U2NvcGVPbkNsb3NlKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKG51bGwsIGZ1bmN0aW9uKGVycm9yKSB7IC8vICdjYXRjaCcgZG9lc24ndCB3b3JrIGluIElFOC5cbiAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcblxuICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfTtcblxuICB9XG5cbiAgcmV0dXJuIG5ldyBNb2RhbFNlcnZpY2UoKTtcbn1dKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=